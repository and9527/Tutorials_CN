-- 建表
CREATE TABLE "C##ABC"."ENTRUST1"
(	"CHANNELNO" NUMBER, 
	"APPLSEQNUM" NUMBER, 
	"MDSTREAMID" NUMBER, 
	"SECURITYID" VARCHAR2(100), 
	"SECURITYIDSOURCE" NUMBER, 
	"PRICE" NUMBER, 
	"SIDE" VARCHAR2(100), 
	"TRADETIME" TIMESTAMP (6), 
	"ORDERQTY" NUMBER, 
	"ORDERTYPE" VARCHAR2(100), 
	"ORDERINDEX" NUMBER, 
	"RECEIVETIME" TIMESTAMP (6), 
	"SEQNO" NUMBER, 
	"MARKET" VARCHAR2(100), 
	"DATASTATUS" NUMBER, 
	"BIZINDEX" NUMBER NOT NULL ENABLE, 
	 PRIMARY KEY ("BIZINDEX"), 
	 SUPPLEMENTAL LOG DATA (ALL) COLUMNS
)

-- 插入数据
DECLARE
  v_total_rows NUMBER := 100000; -- 总共要插入的行数
  day_timestamp TIMESTAMP := TO_TIMESTAMP('2023-01-01 09:00:00', 'YYYY-MM-DD HH24:MI:SS'); -- 初始的TIMESTAMP值
  v_index NUMBER := 0; -- 总共要插入的行数
  start_timestamp TIMESTAMP;
BEGIN
  FOR i IN 1..365 LOOP
	start_timestamp := day_timestamp;
    FOR v_TIME IN 1..100 LOOP
	    FOR v_SECURITYID IN 1..5000 LOOP
	      INSERT INTO ENTRUST1 (CHANNELNO,APPLSEQNUM,SECURITYID,PRICE,SIDE,TRADETIME,ORDERQTY,ORDERTYPE,ORDERINDEX,RECEIVETIME,SEQNO,MARKET,DATASTATUS,BIZINDEX) -- 替换成你的表名和列名
	        VALUES (TRUNC(DBMS_RANDOM.VALUE(0, 20 + 1)),
	      	v_index,
			v_SECURITYID,
			DBMS_RANDOM.VALUE*1000,
			dbms_random.string('a',1),
			start_timestamp,
			DBMS_RANDOM.VALUE*1000,
			dbms_random.string('a',1),
			v_index,
			CURRENT_TIMESTAMP,
			v_index,
			dbms_random.string('a',1),
			TRUNC(DBMS_RANDOM.VALUE(1, 8 + 1)),
			v_index); -- 插入的数据，这里用i和j作为示例
	      v_index := v_index+1;
	      IF v_index>=v_total_rows THEN
	      	EXIT;
	      END IF;
	    END LOOP;
	    IF v_index>=v_total_rows THEN
	      	EXIT;
	    END IF;
	    start_timestamp := start_timestamp+INTERVAL '1' MINUTE;
	    COMMIT; -- 提交每次的插入
	END LOOP;
    IF v_index>=v_total_rows THEN
	    EXIT;
	END IF;
    day_timestamp := day_timestamp+INTERVAL '1' DAY;
  END LOOP;
END;


-- 更新数据
BEGIN
	FOR j IN 1..100000 LOOP
	  UPDATE ENTRUST1 SET PRICE=DBMS_RANDOM.VALUE*1000,
	  	ORDERQTY=DBMS_RANDOM.VALUE*1000,
		RECEIVETIME=CURRENT_TIMESTAMP WHERE BIZINDEX=j;
	END LOOP;
	COMMIT; -- 提交每次的插入
END;

-- 单次修改数据
DECLARE
  v_index NUMBER := 100000; -- 总共要插入的行数
BEGIN
	FOR j IN 1..10 LOOP
	  INSERT INTO ENTRUST1 (CHANNELNO,APPLSEQNUM,SECURITYID,PRICE,SIDE,TRADETIME,ORDERQTY,ORDERTYPE,ORDERINDEX,RECEIVETIME,SEQNO,MARKET,DATASTATUS,BIZINDEX) -- 替换成你的表名和列名
	        VALUES (TRUNC(DBMS_RANDOM.VALUE(0, 20 + 1)),
	      	v_index,
			v_index,
			DBMS_RANDOM.VALUE*1000,
			dbms_random.string('a',1),
			CURRENT_TIMESTAMP,
			DBMS_RANDOM.VALUE*1000,
			dbms_random.string('a',1),
			v_index,
			CURRENT_TIMESTAMP,
			v_index,
			dbms_random.string('a',1),
			TRUNC(DBMS_RANDOM.VALUE(1, 8 + 1)),
			v_index); -- 插入的数据，这里用i和j作为示例
	      v_index := v_index+1;
	  COMMIT; -- 提交
      dbms_lock.sleep(10); -- 等待10秒，确保数据插入完成不影响下一次测试
	END LOOP;
END;

-- 删除数据
DELETE FROM ENTRUST1
